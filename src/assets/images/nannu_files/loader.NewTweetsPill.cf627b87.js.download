(window.webpackJsonp=window.webpackJsonp||[]).push([[233],{"/Nu6":function(e,t,s){"use strict";var a=s("ERkP"),i=s.n(a),n=s("t62R"),r=s("MAI/"),o=s("WXWl"),l=s("I4+6"),c=s("cm6r"),u=s("rHpw"),m=s("MWbm");const p=u.a.create((e=>({root:{backgroundColor:e.colors.primary,borderRadius:e.borderRadii.infinite,boxShadow:e.boxShadows.small,justifyContent:"center",paddingVertical:e.spaces.space4,paddingHorizontal:e.spaces.space16},facepiles:{marginLeft:e.spaces.space4,marginRight:e.spaces.space2},icon:{alignSelf:"center",color:e.colors.whiteOnColor},pillContent:{flexDirection:"row"},pillText:{marginLeft:e.spaces.space4,alignSelf:"center"}})));t.a=function(e){const{label:t,onClick:s,onImpression:a,userAvatarUrls:h}=e;i.a.useEffect((()=>{null==a||a()}),[]);const w=l.a.generate({backgroundColor:u.a.theme.colors.primary,color:u.a.theme.colors.whiteOnColor});return i.a.createElement(m.a,{accessibilityRole:"status"},i.a.createElement(c.a,{interactiveStyles:w,onClick:s,style:p.root},i.a.createElement(m.a,{style:p.pillContent},i.a.createElement(o.a,{style:p.icon}),h&&h.length>0?i.a.createElement(m.a,{style:p.facepiles,testID:"userAvatars"},i.a.createElement(r.a,{borderColor:"primary",userAvatarSize:"large",userAvatarUrls:h})):null,i.a.createElement(n.b,{color:"whiteOnColor",style:p.pillText},t))))}},WXWl:function(e,t,s){"use strict";var a=s("ERkP"),i=s.n(a),n=s("Lsrn"),r=s("k/Ka");const o=(e={})=>Object(r.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[n.a.root,e.style],viewBox:"0 0 24 24"},i.a.createElement("g",null,i.a.createElement("path",{d:"M18.707 10.293l-6-6c-.39-.39-1.023-.39-1.414 0l-6 6c-.39.39-.39 1.023 0 1.414.195.195.45.293.707.293s.512-.098.707-.293L11 7.414V20c0 .553.447 1 1 1s1-.447 1-1V7.414l4.293 4.293c.195.195.45.293.707.293s.512-.098.707-.293c.39-.39.39-1.023 0-1.414z"})));o.metadata={width:24,height:24},t.a=o},cjo7:function(e,t,s){"use strict";s.r(t),s.d(t,"NewTweetsPillv2",(function(){return k}));s("kYxP");var a=s("ERkP"),i=s.n(a),n=s("v6aA"),r=s("lnti"),o=s("hqKg"),l=s("o52z"),c=s("G6rE"),u=s("rxPX");const m=(e,{alert:t})=>t&&t.userIds||Object(l.a)(),p=(e,{module:t})=>t.selectNewTweetsBar(e);var h=Object(u.a)().propsFromState((()=>({userImageUrls:Object(o.createSelector)(c.e.selectAll,m,((e,t)=>t?Object(r.a)(t.map((t=>{const s=e[t];return s?s.profile_image_url_https:void 0}))):[])),newTweetsBar:p}))).withAnalytics({component:"new_tweet_prompt"}),w=s("3XMw"),d=s.n(w),_=s("IbOt"),b=s("fs1G"),y=s("FGLp"),g=s("MWbm"),f=s("tLTi"),T=s("/Nu6"),S=s("rHpw");const v=d.a.gdb8bdcc,D=d.a.ac0f6492,C={};function k(e){const{alert:t,analytics:s,label:a,module:r,newTweetsBar:o,remainVisibleInterval:l,removeAlert:c,timelineId:u,triggerDelay:m,unreadCount:p,userImageUrls:h}=e,{featureSwitches:w}=i.a.useContext(n.a),[d,S]=i.a.useState(!1),v=i.a.useRef(),k=i.a.useRef(),A=i.a.useRef(),I=i.a.useRef(t),E=i.a.useRef(u),R=i.a.useRef(c),O=w.getNumberValue("responsive_web_home_sticky_new_tweets_pill_delay_seconds",1),L=w.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"),M=w.getNumberValue("responsive_web_home_sticky_new_tweets_pill_duration_seconds",-1);Object(y.a)((()=>(P()||V(u),W(),A.current=Object(_.a)({onUp:b.a,onDown:z}),()=>{k.current&&clearTimeout(k.current),v.current&&clearTimeout(v.current),d&&(V(u),null==c||c()),null==A.current||A.current()})));const j=i.a.useCallback((e=>{s.scribeAction(e)}),[s]),P=i.a.useCallback((()=>C[u]),[u]),N=i.a.useCallback((()=>{const e=L&&O>0?1e3*O:t&&t.triggerDelayMs||o&&Math.floor((o.lastRevealedTimestamp||0)/1e3)||m;return P()+e-Date.now()}),[t,O,L,P,o,m]),V=i.a.useCallback((e=>{e&&(C[e]=Date.now())}),[]),U=i.a.useCallback((()=>{V(u),S(!1),(t||o.count>0)&&setTimeout((()=>c()),500)}),[t,o,V,c,u]),W=i.a.useCallback((()=>{if(k.current&&(clearTimeout(k.current),k.current=null),t&&!d||o.count>0&&!d||p>0){const e=N();e<=0?(S(!0),C[u]=Date.now(),j("show"),L&&M>0&&(v.current=setTimeout(U,1e3*M))):k.current=setTimeout(W,e)}}),[t,N,U,L,o,j,d,M,u,p]),z=()=>{if(t&&d&&L)return;let e=l;t&&t.displayDurationMs&&t.displayDurationMs>-1&&(e=t.displayDurationMs),d&&Date.now()>=C[u]+e&&(j("dismiss"),U())};i.a.useEffect((()=>{const e=E.current!==u,s=e&&!P();e?(s&&V(u),d&&V(u),null==R.current||R.current(),S(!1),W()):t&&!d||o.count>0&&!d||p>0?W():!I.current&&0!==p||t||U()}),[t,P,U,u,V,p]);const H=(null==t?void 0:t.richText)&&i.a.createElement(f.a,{entities:t.richText.entities,text:t.richText.text});return i.a.createElement(g.a,{accessibilityLabel:D,style:[x.pill,d&&x.show],testID:"pill-container"},i.a.createElement(T.a,{label:H||a,onClick:()=>{j("click"),window.scrollTo(0,0),null==r.applyNewTweetsBarInstructions||r.applyNewTweetsBarInstructions(),U()},userAvatarUrls:h}))}k.defaultProps={isAtNewest:!0,label:v,remainVisibleInterval:1e3,triggerDelay:3e3,unreadCount:0};const x=S.a.create((e=>({pill:{opacity:0,transform:[{translate3d:"0, 0, 0"}],transitionProperty:"transform, opacity",transitionDuration:"0.15s",transitionTimingFunction:"ease, ease, step-end"},show:{opacity:1,transitionTimingFunction:"ease, ease, step-start",transform:[{translate3d:"0, 3.5em, 0"}]}})));t.default=h(k)},o52z:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var a=s("VPAj");const i=Object(a.a)([]);Object(a.a)({})},xAHt:function(e,t,s){"use strict";s.r(t),s.d(t,"NewTweetsPill",(function(){return I}));s("kYxP");var a=s("ERkP"),i=s.n(a),n=s("lnti"),r=s("hqKg"),o=s("o52z"),l=s("G6rE"),c=s("rxPX");const u=(e,t)=>t.alert&&t.alert.userIds||Object(o.a)();var m=Object(c.a)().propsFromState((()=>({userImageUrls:Object(r.createSelector)(l.e.selectAll,u,((e,t)=>t?Object(n.a)(t.map((t=>{const s=e[t];return s?s.profile_image_url_https:void 0}))):[]))}))).withAnalytics({component:"new_tweet_prompt"}),p=s("3XMw"),h=s.n(p),w=s("WXWl"),d=s("IbOt"),_=s("fs1G"),b=s("rcen"),y=s("MWbm"),g=s("I4+6"),f=s("rHpw"),T=s("cm6r"),S=s("MAI/"),v=s("t62R"),D=s("v6aA");const C=h.a.gdb8bdcc,k=h.a.ac0f6492,x={},A={};class I extends i.a.PureComponent{constructor(...e){super(...e),this.state={show:!1},this._getLastShownTime=()=>A[this.props.timelineId],this._hide=()=>{const{alert:e,removeAlert:t,timelineId:s}=this.props;this._mounted&&(this._updateLastShownTime(s),this.setState({show:!1})),e&&setTimeout((()=>t()),500)},this._attemptShow=()=>{const{featureSwitches:e}=this.context,{alert:t,isAtNewest:s,removeAlert:a,timelineId:i,unreadCount:n}=this.props;if(this._attemptShowTimeout&&(clearTimeout(this._attemptShowTimeout),this._attemptShowTimeout=null),this._mounted&&(t||n>0)){const n=this._getDelayRemaining();if(n<=0){if(t&&s())return void a();this.setState({show:!0}),x[i]=Date.now(),this._scribeAction("show");const n=e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"),r=e.getNumberValue("responsive_web_home_sticky_new_tweets_pill_duration_seconds",-1);n&&r>0&&(this._autoDismissTimeout=setTimeout(this._hide,1e3*r))}else this._attemptShowTimeout=setTimeout(this._attemptShow,n)}},this._handleScrollDown=()=>{const{featureSwitches:e}=this.context,{alert:t,remainVisibleInterval:s,timelineId:a}=this.props;if(t&&this.state.show&&e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"))return;let i=s;t&&t.displayDurationMs&&t.displayDurationMs>-1&&(i=t.displayDurationMs),this.state.show&&Date.now()>=x[a]+i&&(this._scribeAction("dismiss"),this._hide())},this._handleClick=()=>{const{applyNewTweetsBarInstructions:e}=this.props;this._scribeAction("click"),window.scrollTo(0,0),null==e||e(),this._hide()}}componentDidMount(){this._mounted=!0,this._getLastShownTime()||this._updateLastShownTime(this.props.timelineId),this._attemptShow(),this._cancelMomentum=Object(d.a)({onUp:_.a,onDown:this._handleScrollDown})}componentDidUpdate(e,t){const{alert:s,timelineId:a,unreadCount:i}=this.props,n=e.timelineId!==a,r=n&&!this._getLastShownTime();n?(r&&this._updateLastShownTime(a),t.show&&this._updateLastShownTime(e.timelineId),null==e.removeAlert||e.removeAlert(),this.setState({show:!1}),this._attemptShow()):((s&&!t.show||i>e.unreadCount)&&this._attemptShow(),!e.alert&&0!==i||s||this._hide())}componentWillUnmount(){const{removeAlert:e,timelineId:t}=this.props;this._mounted=!1,this._attemptShowTimeout&&clearTimeout(this._attemptShowTimeout),this._autoDismissTimeout&&clearTimeout(this._autoDismissTimeout),this.state.show&&(this._updateLastShownTime(t),null==e||e()),this._cancelMomentum()}render(){const{alert:e,label:t,userImageUrls:s}=this.props,{show:a}=this.state;let n;n=e?e.richText&&i.a.createElement(b.a,{entities:e.richText.entities,text:e.richText.text}):t;const r=g.a.generate({backgroundColor:f.a.theme.colors.primary,color:f.a.theme.colors.whiteOnColor});return i.a.createElement(y.a,{accessibilityRole:"status"},i.a.createElement(T.a,{accessibilityHidden:!a,accessibilityLabel:k,accessibilityRole:"button",interactiveStyles:r,onClick:this._handleClick,style:[E.pill,a&&E.show]},i.a.createElement(y.a,{style:E.innerPill},i.a.createElement(w.a,{style:E.icon}),s&&s.length>0?i.a.createElement(y.a,{style:E.facepile},i.a.createElement(S.a,{borderColor:"primary",userAvatarSize:"large",userAvatarUrls:s})):null,i.a.createElement(v.b,{color:"whiteOnColor",numberOfLines:1,style:E.pillText},n))))}_getDelayRemaining(){const{featureSwitches:e}=this.context,{alert:t,triggerDelay:s}=this.props,a=e.getNumberValue("responsive_web_home_sticky_new_tweets_pill_delay_seconds",1),i=e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled")&&a>0?1e3*a:t&&t.triggerDelayMs||s;return this._getLastShownTime()+i-Date.now()}_updateLastShownTime(e){e&&(A[e]=Date.now())}_scribeAction(e){const{analytics:t}=this.props;t.scribeAction(e)}}I.contextType=D.a,I.defaultProps={isAtNewest:()=>!0,label:C,remainVisibleInterval:3e3,triggerDelay:24e4,unreadCount:0};const E=f.a.create((e=>({pill:{boxShadow:e.boxShadows.small,backgroundColor:e.colors.primary,borderRadius:e.borderRadii.infinite,paddingHorizontal:e.spaces.space16,opacity:0,justifyContent:"center",transform:[{translate3d:"0, 0, 0"}],transitionProperty:"transform, opacity",transitionDuration:"0.15s",transitionTimingFunction:"ease, ease, step-end"},innerPill:{flexDirection:"row",paddingVertical:e.spaces.space4},icon:{width:e.spaces.space20,marginRight:e.spaces.space4,alignSelf:"center",color:e.colors.whiteOnColor},facepile:{marginRight:e.spaces.space8},pillText:{alignSelf:"center"},show:{opacity:1,transitionTimingFunction:"ease, ease, step-start",transform:[{translate3d:"0, 3.5em, 0"}]}}))),R=m(I);t.default=R}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.NewTweetsPill.cf627b87.js.map